# Implementation Tasks

## 1. 核心逻辑实现

- [x] 1.1 创建 `useMetronome` hook
  - [x] 1.1.1 使用 Web Audio API 生成节拍音效（OscillatorNode + GainNode）
  - [x] 1.1.2 实现强拍/弱拍音色区分（强拍 800Hz，弱拍 600Hz）
  - [x] 1.1.3 实现 BPM 转换为毫秒间隔的计算逻辑
  - [x] 1.1.4 使用 `setInterval` 或 Web Audio API 的时钟实现精确定时
  - [x] 1.1.5 提供开始/停止/BPM 设置的接口
  - [x] 1.1.6 实现当前拍号跟踪（1, 2, 3, 4 循环）
  - [x] 1.1.7 处理组件卸载时的清理逻辑

- [x] 1.2 BPM 设置持久化
  - [x] 1.2.1 使用 localStorage 保存用户的 BPM 设置
  - [x] 1.2.2 页面加载时恢复上次的 BPM 设置

## 2. UI 组件开发

- [x] 2.1 创建 `Metronome` 组件
  - [x] 2.1.1 BPM 滑块控件（使用 Shadcn UI 的 Slider 组件）
  - [x] 2.1.2 BPM 数值显示（可手动输入）
  - [x] 2.1.3 开始/停止按钮（使用 Lucide 图标）
  - [x] 2.1.4 视觉节拍指示器（4 个圆点，当前拍高亮）
  - [x] 2.1.5 响应式设计（桌面和移动端适配）

- [x] 2.2 集成到 `PlaybackControls`
  - [x] 2.2.1 在播放控制区域添加节拍器组件
  - [x] 2.2.2 调整布局确保不拥挤（使用 Separator 分隔）
  - [x] 2.2.3 确保节拍器与扫弦/分解按钮视觉和谐

- [x] 2.3 移动端优化
  - [x] 2.3.1 在移动端侧边栏（Sheet）中显示节拍器
  - [x] 2.3.2 确保触摸操作友好（按钮大小、滑块灵敏度）

## 3. 样式和用户体验

- [x] 3.1 视觉节拍指示器动画
  - [x] 3.1.1 当前拍圆点放大并高亮
  - [x] 3.1.2 使用 Tailwind 动画实现平滑过渡

- [x] 3.2 用户交互反馈
  - [x] 3.2.1 播放节拍器时显示"运行中"状态
  - [x] 3.2.2 BPM 调整时即时反馈（无需重启节拍器）

- [x] 3.3 无障碍优化
  - [x] 3.3.1 为按钮添加 aria-label
  - [x] 3.3.2 键盘快捷键支持（空格键开始/停止）

## 4. 测试和验证

- [x] 4.1 功能测试
  - [x] 4.1.1 验证不同 BPM 下的节拍准确性
  - [x] 4.1.2 测试强拍/弱拍音色区分
  - [x] 4.1.3 验证开始/停止的即时响应
  - [x] 4.1.4 测试 BPM 持久化（刷新页面后恢复）

- [x] 4.2 兼容性测试
  - [x] 4.2.1 测试与现有音频播放功能共存（同时使用节拍器和扫弦）
  - [x] 4.2.2 测试浏览器兼容性（Chrome、Firefox、Safari）
  - [x] 4.2.3 测试移动端（iOS Safari、Android Chrome）

- [x] 4.3 边界情况
  - [x] 4.3.1 验证极限 BPM（40 和 240）的表现
  - [x] 4.3.2 测试快速切换 BPM 的稳定性
  - [x] 4.3.3 测试页面最小化或切换标签页时的行为

## 5. 文档和收尾

- [x] 5.1 更新 README.md
  - [x] 5.1.1 添加节拍器功能说明
  - [x] 5.1.2 更新功能列表

- [x] 5.2 代码审查
  - [x] 5.2.1 确保代码符合项目规范（TypeScript 严格模式）
  - [x] 5.2.2 检查 ESLint 无错误

- [x] 5.3 性能优化
  - [x] 5.3.1 确认定时器准确性（使用 Web Audio API 时钟而非 setInterval）
  - [x] 5.3.2 验证无内存泄漏（组件卸载时清理）
